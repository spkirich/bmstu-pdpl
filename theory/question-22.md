# Прерывания. Обработка в реальном режиме работы процессора

_Прерывание_ - событие, требующее немедленной передачи управления особой
подпрограмме, называемой _обработчиком_.

Виды прерываний:

- _Аппаратные_ - события периферии
- _Внутренние_ - события процессора

Также выделяют _программные_ прерывания - явным образом вызываемые в
программе.

Некоторые аппаратные прерывания можно _маскировать_ - запрещать их обработку.
Таким образом, их делят на _маскируемые_ и _немаскируемые_.

_Вектор прерывания_ - идентификатор соответствующего обработчика. Поскольку
прерывание может произойти в любом месте программы, вектор должен хранить не
только смещение, но и сегментную часть адреса. Поэтому в реальном режиме
работы процессора он занимает 4 байта.

Все возможные векторы составляют _таблицу векторов прерываний_. В реальном
режиме работы процессора она располагается в самом начале памяти и занимает
1 КиБ. Путём несложных арифметических действий сильный студент может прийти
к выводу, что таблица рассчитана на 256 прерываний.

Перед тем, как передать управление обработчику, необходимо сохранить на стеке
регистр флагов и полный адрес возврата. Поэтому для возврата из обработчика
используется особая команда:

```asm
IRET
```

Она восстанавливает значение регистра флагов и передаёт управление прерванной
подпрограмме.

Прерывания можно _перехватывать_ - подменять их обработчики своими. Для этого
в общем случае необходимо:

- Сохранить старый вектор
- Подменить его новым вектором
- Из своего обработчика вызвать старый
- По завершении программы восстановить вектор
